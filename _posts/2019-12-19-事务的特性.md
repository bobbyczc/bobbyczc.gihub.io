---
layout: post
title: '事务的四大特性'
subtitle: '数据库事务'
date: 2019-12-19
categories: 数据库
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-theme-h2o-postcover.jpg'
tags: 数据库
---

# 事务

## 事务的定义

事务是**一系列操作组成的工作单元** ，该工作单元内的操作是不可分割的，即要么所有操作都做，要么所有操作都不做。

以你给老妈转账1000元为例，“你账户减少1000元”和“老妈账户增加1000元”这两个事件必须是都是成功的，或者都是失败的。

## 本地事务与分布式事务

**本地事务** ：由于应用主要靠关系型数据库来控制事务，而数据库通常和应用在同一个服务器，这种情形的事务叫做本地事务

**分布式事务** ：一个系统可以由多个服务组成，多个服务不在同一个服务器上，有些事务需要多个服务之间的远程调用才能完成，这种分布式系统环境下由不同的服务之前通过网络协作完成事务成为分布式任务。

##  事务的四大特性

事务的四大特性为ACID

- **Atomicity原子性** ：原子性指事务是一个不可分割的工作单元；同一事务中的sql语句必须全部执行成功或者失败。

  ```sql
  begin transaction;
  	update account set money = money-1000 where name = "you";
  	update account set money = money+1000 where name = "your mom";
  commit transaction;
  ```

  转账和到账在同一事务中

- **Consistency一致性** ：事务必须按照预期生效，使数据库从一个一致性的状态到另一个一致性的状态

  意思是说，转账1000必须到账1000，而不是到账2000，保持一致

- **Isolation隔离性** ：多个并发事务之间要相互隔离，不能影响其他事务的操作

- **Durability持久性** ：事务一旦提交，对数据库中的数据的改变是永久的，接下来即使数据库发生故障也不应该有所影响